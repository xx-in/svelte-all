# 三、单纯形法（Simplex Method）

单纯形法是一种用于求解 **线性规划问题（Linear Programming, LP）**
的经典算法。线性规划是凸规划的一种。

## 一、 标准形式

线性规划的标准形式为：

$$
\begin{aligned}
\min \quad & z = c^T x \\
\text{s.t.} \quad & A x = b, \\
& x \ge 0
\end{aligned}
$$

其中：

- $x \in \mathbb{R}^n$ 为决策变量，但是要求$x$非负时才有意义；
- $A \in \mathbb{R}^{m \times n}$；
- $b \in \mathbb{R}_+^m$，等式中的值都要求是正数；
- $c \in \mathbb{R}^n$。

## 二、转化为标准型

对于一般的线性规划问题，通常不是标准型，我们需要将原问题转化为标准形式：

1. 最大化问题可以通过负号转换为最小化问题

   $$
   \max \; c^T x \quad
   \Rightarrow \quad \min \;
   \big(-c^T x\big)
   $$

2. 决策变量$x_i$无约束，即无非负约束时，可拆分为两个新的决策变量

   $$
   x_i \in \mathbb{R} \quad \Rightarrow \quad  x_i = x_{i1} - x_{i2}, \quad x_{i1} \ge 0 ,\quad x_{i2} \ge 0
   $$

3. 不等式约束转换为等式约束，额外增加新的松弛变量（决策变量）转换为等式

$$
a^Tx_i \le b \quad\Rightarrow\quad a^Tx_i + s_i = b , s_i \ge 0
$$

$$
a^Tx_j \ge b \quad\Rightarrow\quad a^Tx_j - s_j = b , s_j \ge 0
$$

> 注：当修改决策变量的数量时，需要同步替换目标函数中的决策变量。不等式约束只处理不等式部分，对于等式部分跳过即可，因为该部分已经是标准形式了

## 三、基本变量与非基本变量

将约束 $A x = b$ 中的变量分为：

- **基本变量（basic variables）**：对应 $A$ 的一个可逆子矩阵 $B$；
- **非基本变量（nonbasic variables）**：其余变量。

根据分块矩阵设：

$$
x = \begin{bmatrix} x_B \\ x_N \end{bmatrix}, \quad A = [B \; N]
$$

则根据分块矩阵计算公式有：

$$
B x_B + N x_N = b \quad
$$

因为$B$是可逆矩阵，左乘$B^{-1}$并调整有：

$$
\quad x_B = B^{-1} b - B^{-1} N x_N
$$

当 $x_N = 0$ 时，可得一个 **基本可行解（BFS）**：

$$
x_B = B^{-1} b, \quad x_N = 0
$$

> 为什么可以让非基变量$x_N =0$? 因为$B$是可逆矩阵，则其满秩，$N$一定可以由$B$线性表示。

### （4）检验最优性

目标函数为：

$$

z = c_B^T x_B + c_N^T x_N


$$

代入 $x_B = B^{-1} b - B^{-1} N x_N$ 得：

$$

z = c_B^T B^{-1} b + (c_N^T - c_B^T B^{-1} N)x_N


$$

定义 **检验数（reduced cost）**：

$$

\bar{c}\_N^T = c_N^T - c_B^T B^{-1} N


$$

- 若所有 $\bar{c}_N \le 0$（最大化问题），则当前解为最优；
- 否则，选择 $\bar{c}_j > 0$ 的变量进入基。

### （5）换基操作（Pivot）

1. **入基变量（Entering Variable）**：选取 $\bar{c}_j > 0$ 的非基本变量 $x_j$。

2. **出基变量（Leaving Variable）**：为保持 $x_B \ge 0$，计算：

$$

\theta_i = \frac{(B^{-1} b)\_i}{(B^{-1} N_j)\_i}, \quad (B^{-1} N_j)\_i > 0


$$

取最小比率：

$$

\theta = \min_i \theta_i


$$

对应的 $x_{B_i}$ 出基。

3. **更新基矩阵**：用 $x_j$ 替换 $x_{B_i}$，得到新的 $B$，继续迭代。

### （6）终止条件

- 若所有 $\bar{c}_N \le 0$，则当前解最优；
- 若存在 $(B^{-1} N_j) \le 0$，则问题无界；
- 若 $b < 0$ 无可行解，可用“大 $M$ 法”或“两阶段法”求初始可行基。

### （7）示例

求：

$$

\max z = 3x_1 + 2x_2


$$

约束：

$$

\begin{cases} x_1 + x_2 \le 4 \\ x_1 \le 2 \\ x_2 \le 3 \\ x_1, x_2 \ge 0 \end{cases}


$$

引入松弛变量：

$$

\begin{aligned} x_1 + x_2 + s_1 &= 4 \\ x_1 + s_2 &= 2 \\ x_2 + s_3 &= 3 \end{aligned}


$$

初始基：$B = [s_1, s_2, s_3]$

初始解：

$$

x_1 = 0, \; x_2 = 0, \; s_1 = 4, \; s_2 = 2, \; s_3 = 3


$$

通过单纯形表迭代，最终得到最优解：

$$

x*1 = 1, \; x_2 = 3, \; z*{\max} = 9


$$
