# 线性规划的对偶理论

线性规划的对偶理论揭示了 **原始问题（Primal）** 与 **对偶问题（Dual）** 之间的对称与等价关系。

在实际问题中，求解原始问题（Primal Problem）可能比较复杂，而对偶问题（Dual
Problem）有时更简单、约束更少或结构更清晰。

这里的线性规划问题通常不是标准形式，也不需要将其转化为标准形式，因为这样得出的对偶问题更直观，更是因为即便是一般形式的线性规划也可以直接在计算机中解决，标准形式只是给单纯形法使用的。

---

## 一、弱对偶与强对偶

- **弱对偶**：

$$
\text{最大值问题（对偶问题）的任意可行解} \le \text{最小值问题的任意可行解}
$$

- **强对偶**：若原问题和对偶问题均有可行解，则一定存在最优解，并且：

$$
\text{最大化问题的最优解} = \text{最小化问题的最优解}
$$

---

## 二、转换规则

线性规划问题的对偶转换遵循以下规则，对于其中变量的表示含义，在示例中详细描述：

> 对偶问题的方向至关重要：

- 若是$min \Rightarrow max$，下表从左向右看
- 若是$max \Rightarrow min$，下表从右向左看

|    $min$ 最小化问题    |    $max$ 最大化问题    |
| :--------------------: | :--------------------: |
|          $A$           |         $A^T$          |
|          $c$           |         $b^T$          |
|          $b$           |         $c^T$          |
| 第$j$条约束符号 $\ge $ |    变量$w_j \ge 0$     |
| 第$j$条约束符号 $\le $ |    变量$w_j \le 0$     |
|  第$j$条约束符号 $= $  |    变量$w_j 无约束$    |
|    变量$x_i \le 0$     | 第$i$条约束符号 $\ge $ |
|    变量$x_i \ge 0$     | 第$i$条约束符号 $\le $ |
|    变量$x_i$ 无约束    |  第$i$条约束符号 $=$   |

## 三、 对偶问题求解示例

$$
\begin{aligned}
min \quad 2x_1 + x_2 + 2x_3 \\
s.t. \quad x_1 +x_2 +2x_3 \ge 1 \\
x_1  - x_2 + x_3 \le 2 \\
-x_1  + x_2 + x_3 = 1  \\
x_1 \ge 0,\quad x_2\text{无约束},\quad x_3 \le 0

\end{aligned}
$$

其中原问题各变量：

$$
A = \begin{bmatrix}
1&1&2\\
1&-1&1\\
-1&1&2\\
\end{bmatrix}
$$

$$
b = \begin{bmatrix}
1\\
2\\
1\\
\end{bmatrix}
$$

$$
c = \begin{bmatrix}
2&1&2\\
\end{bmatrix}
$$

构建对偶问题的各变量：

$$
A^T = \begin{bmatrix}
1&1&-1\\
1&-1&1\\
2&1&2\\
\end{bmatrix}
$$

$$
b^T = \begin{bmatrix}
1&
2&
1&
\end{bmatrix}
$$

$$
c^T = \begin{bmatrix}2\\1\\2\end{bmatrix}
$$

构建对偶问题：

$$
\begin{aligned}
max \quad w_1 + 2w_2 + w_3 \\
s.t. \quad w_1  + w_2 - w_3 \le 2 \\
w_1  - w_2 + w_3 = 1  \\
2w_1  + w_2 + 2w_3 \ge 2  \\
w_1 \ge 0,\quad w_2 \le 0, \quad w_3 \text{无约束}
\end{aligned}
$$

## 四、 互补松弛定理

原问题和对偶问题满足互补松弛定理，该定理的核心只有两条：

- 起作用约束的值一定不是零
- 无作用约束的值一定是零

所谓起作用约束就是使得不等式约束条件恰好使得等式成立的约束。

### （1）列出问题

如以下原问题：

$$
\begin{aligned}
\max z = x_1 + 2x_2 + 3x_3 + 4x_4\\
 \text{s.t.} \quad x_1 + 2x_2 + 2x_3 + 3x_4 \leq 20
 \\ 2x_1 + x_2 + 3x_3 + 2x_4 \leq 20
 \\ x_1, x_2, x_3, x_4 \geq 0
 \end{aligned}
$$

和对偶问题：

$$
\begin{aligned}
\min w = 20y_1 + 20y_2 \\
\text{s.t.} \quad y_1 + 2y_2 \geq 1 \\
2y_1 + y_2 \geq 2 \\
2y_1 + 3y_2 \geq 3 \\
3y_1 + 2y_2 \geq 4 \\
y_1, y_2 \geq 0
\end{aligned}
$$

若$y^*=(\frac{6}{5},\frac{1}{5})$是对偶问题的最优解，求出原问题的最优解。

### (2) 将对偶最优解带入约束条件计算

$$
\begin{cases}
y_1^* + 2y_2^*  = \frac{7}{5} \geq 1 \\
2y_1^* + y_2^* \frac{13}{5} \geq 2 \\
2y_1^* + 3y_2^* = 3\\
3y_1^* + 2y_2^* = 4
\end{cases}
$$

前两者为不等式，为不起作用约束，后两者为等式，为起作用约束。根据对偶约束条件和原问题决策变量的对应关系有：

$$
\begin{cases}
x_1^* = 0\\
x_2^* = 0
\end{cases}


$$

且因为 $y^*=(\frac{6}{5},\frac{1}{5})$
中两个变量均不为零，则原问题的两个约束条件均为起作用约束，结合上式可以得到方程组：

$$
\begin{cases}
x^*_1 = 0 \\
x^*_2 = 0 \\
x^*_1 + 2x^*_2 + 2x^*_3 + 3x^*_4 = 20 \\
2^*x_1 + x^*_2 + 3x^*_3 + 2x^*_4 = 20
\end{cases}
$$

解得：

$$
\begin{cases}
x_1^* = 0 \\
x_2^* = 0 \\
x_3^* = 4 \\
x_4^* = 4 \\
\end{cases}
$$

故原问题的最优解为$x^* = (0,0,4,4)$。

## 五、总结

- 对于最小化问题到最大化问题：$min \Rightarrow max$
  1. 对偶问题决策变量方向和原问题约束条件方向一致
  2. 对偶问题约束条件方向和原问题变量方向相反

- 对于最大化问题到最小化问题：$max \Rightarrow min$
  1. 对偶问题决策变量方向和原问题约束条件方向相反
  2. 对偶问题约束条件方向和原问题变量方向一致

> 只需记住$min \Rightarrow max$, $约束条件方向 \Rightarrow 决策变量方向$。
