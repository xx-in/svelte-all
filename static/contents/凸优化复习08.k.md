# 最速下降法、牛顿法和共轭梯度法

这三种方法都是用于求解 **无约束最优化问题**：

```html
sdfjlksdjf
```

```js
const a = 12;
```

$$
\min_{x \in \mathbb{R}^n} f(x)
$$

其中 $f(x)$ 可微，甚至二阶可微。

在解决问题之前，需要先了解以下两个量代表的几何含义：

- 梯度是函数在该点的 “变化率向量”，梯度越大则越陡，梯度越小则越平缓
- 梯度的二阶范数则是表示梯度大小的直接观测量，当梯度范数足够小时，意味着已接近平缓区域

---

## 一、最速下降法（Steepest Descent Method）

在当前点 $x_k$ 处，沿 **负梯度方向**（下降最快方向）搜索：

$$
d_k = - \nabla f(x_k)
$$

其中步长 $\lambda_k > 0$,用 $\epsilon$表示允许的误差精度，当$\|d^{(k)}\| \le \epsilon$时，停止计算。

对于梯度和梯度二阶范数的计算我们已经很熟悉了，但是步长$\lambda_k$是怎么算的？？?

步长指的是将当前函数点移动的距离，是一个数字，为了接近最优点，最速下降法要求沿着负梯度方向一直走到该方向的最小函数点上。其中:

$$
\varphi(\lambda_k) = f(x_k+\lambda_k d_k)
$$

需要计算$\lambda_k$使得函数$\varphi(\lambda_k)$取得最小值，也就是：

$$
\varphi'(\lambda_k) = 0
$$

通过上式计算出步长后，我们就能获得一个新的点$x_{k+1} = x_k + \lambda_k d_k$，然后开始下一次计算。

> 该算法比较符合直观理解，但对于实际问题，收敛速度可能非常慢。

---

## 二、牛顿法（Newton’s Method）

该方法则在最速下降法的基础上进行了改进，利用 **泰勒二阶展开** 近似目标函数：

$$
f(x) \approx f(x_k) + \nabla f(x_k)^T (x - x_k)
+ \frac{1}{2} (x - x_k)^T \nabla^2 f(x_k) (x - x_k)
$$

令梯度为 0，得到更新方向：

$$
d_k = - [\nabla^2 f(x_k)]^{-1} \nabla f(x_k)
$$

这里步长不用计算，默认为$1$，更新公式：

$$
x_{k+1} = x_k + d_k = x_k - [\nabla^2 f(x_k)]^{-1} \nabla f(x_k)
$$

牛顿法解题会出现三种情况：

- 收敛到极小点
- 收敛到鞍点
- 海森矩阵不可逆，无法继续

所以牛顿法的初始点非常重要。

> 牛顿法不用计算步长，计算出方向就是下一个点！！！。

---

## 三、 共轭梯度法（Conjugate Gradient Method）

用于求解 **二次优化问题** 或 **大型稀疏对称正定线性方程组**：

$$
f(x) = \frac{1}{2} x^T A x - b^T x, \quad A \succ 0
$$

等价于求解：

$$
A x = b
$$

构造一系列 **A-共轭方向** $\{d_k\}$，在每个方向上一次到达最优点。

初始化：

$$
x_0 \text{ 给定}, \quad r_0 = b - A x_0, \quad d_0 = r_0
$$

迭代：

$$
\lambda_k = \frac{r_k^T r_k}{d_k^T A d_k}, \quad
x_{k+1} = x_k + \lambda_k d_k
$$

更新残差和方向：

$$
r_{k+1} = r_k - \lambda_k A d_k, \quad
\beta_k = \frac{r_{k+1}^T r_{k+1}}{r_k^T r_k}, \quad
d_{k+1} = r_{k+1} + \beta_k d_k
$$

- 不需要存储或求逆矩阵；
- 理论上 $n$ 步收敛（精确算术下）；
- 实际中非常高效，适合大规模问题。

---

## 四、方法比较

|    方法    | 方向                                   | 收敛速度 | 是否用海森矩阵 | 适用规模     |
| :--------: | :------------------------------------- | :------- | :------------- | :----------- |
| 最速下降法 | $-\nabla f(x_k)$                       | 线性     | 否             | 小型         |
|   牛顿法   | $-[\nabla^2 f(x_k)]^{-1}\nabla f(x_k)$ | 二次     | 是             | 小型到中型   |
| 共轭梯度法 | A-共轭方向                             | 超线性   | 只需矩阵乘法   | 大型稀疏系统 |

所有方法都需要大量复杂的运算，正常都需要使用计算机来计算。
