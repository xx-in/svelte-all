# 最优性条件

KKT 条件（Karush–Kuhn–Tucker Conditions）是带约束优化中判断最优解的核心工具。  
它不仅描述了一阶平衡，还能通过二阶信息判断候选点是否最优或鞍点。

---

## 一、KKT 条件的含义

- KKT 条件是一组代数方程与不等式，用于判断点 $x^*$ 是否可能是最优解（候选点）。
- 它结合了：
  1. **原始约束**（Primal feasibility）
  2. **对偶约束**（Dual feasibility）
  3. **互补松弛**（Complementary slackness）
  4. **梯度平衡条件**（Stationarity）

---

## 二、KKT 条件的一般形式

对于问题：

$$
\min_{x} \quad f(x), \quad
\text{s.t. } \ g_i(x) \le 0, \ i = 1, \dots, m, \quad
h_j(x) = 0, \ j = 1, \dots, p
$$

引入拉格朗日乘子 $\lambda_i \ge 0$（不等式）与 $\mu_j$（等式），KKT 条件为：

$$
\begin{cases}
\nabla f(x^*) + \displaystyle\sum_{i=1}^m \lambda_i^* \nabla g_i(x^*)
  + \displaystyle\sum_{j=1}^p \mu_j^* \nabla h_j(x^*) = 0, & \text{(Stationarity)} \\[8pt]
g_i(x^*) \le 0, \quad h_j(x^*) = 0, & \text{(Feasibility)} \\[6pt]
\lambda_i^* \ge 0, & \text{(Dual feasibility)} \\[6pt]
\lambda_i^* g_i(x^*) = 0, & \text{(Complementary slackness)}
\end{cases}
$$

---

## 三、线性规划中的 KKT 条件

对于线性规划：

$$
\min_x \quad c^T x,
\quad \text{s.t. } \ A x = b, \ x \ge 0
$$

KKT 条件为：

$$
\begin{cases}
A x^* = b, & x^* \ge 0, \\[6pt]
A^T y^* + s^* = c, & s^* \ge 0, \\[6pt]
s_i^* x_i^* = 0, & \forall i
\end{cases}
$$

其中：

- $y$ 是等式约束的拉格朗日乘子；
- $s$ 是非负约束对应的对偶变量；
- $s_i x_i = 0$ 表示互补松弛。

---

## 四、KKT 条件的计算步骤

1. 写出拉格朗日函数：

   $$
   L(x, \lambda, \mu) = f(x) + \sum_i \lambda_i g_i(x) + \sum_j \mu_j h_j(x)
   $$

2. 计算一阶偏导：

   $$
   \nabla_x L(x, \lambda, \mu) = 0
   $$

3. 代入约束条件：

   $$
   g_i(x) \le 0, \quad h_j(x) = 0
   $$

4. 添加互补松弛条件：

   $$
   \lambda_i g_i(x) = 0, \quad \lambda_i \ge 0
   $$

5. 联立方程求解，得到候选点 $(x^*, \lambda^*, \mu^*)$。

---

## 五、判断 KKT 点是否最优或鞍点

1. **凸优化问题**

   若目标函数 $f$ 和不等式约束 $g_i$ 均为凸函数，等式约束 $h_j$ 为线性函数，  
   则任何满足 KKT 条件的点 $x^*$ **必为全局最优**。

2. **非凸问题**

   构造拉格朗日 Hessian：

   $$
   H = \nabla^2_{xx} L(x^*, \lambda^*, \mu^*)
   $$

   检查 **可行方向上的二阶曲率**：

   $$
   \mathcal{D}(x^*) =
   \{ d \mid \nabla h_j(x^*)^T d = 0, \
   \nabla g_i(x^*)^T d \le 0 \text{ for active } i \}
   $$

   若 $d^T H d \ge 0$ 对所有 $d \in \mathcal{D}(x^*)$，则 $x^*$ 为局部极小点；  
   若 $H$ 不定，则 $x^*$ 为鞍点；若负定，则为局部极大点。

3. **直观理解**
   - KKT 条件保证一阶梯度平衡：没有沿可行方向立即下降的趋势；
   - Hessian 检查决定二阶曲率：向上 → 极小，向下 → 极大，正负混合 → 鞍点。

---

## 六、小结

- KKT 条件提供候选最优点；
- **凸性** 可确保 KKT 点为全局最优；
- **Hessian 正定性** 可区分局部极小点与鞍点；
- 对线性规划，KKT 条件与对偶理论完全等价。
