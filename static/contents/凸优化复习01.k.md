# 凸集、凸函数和凸规划

## 一、凸集（Convex Set）

一个集合 $S \subseteq \mathbb{R}^n$ 被称为 **凸集**，如果对于任意的 $x_1, x_2 \in S$ 和任意满足
$0 \le \theta \le 1$ 的实数 $\theta$，都有：

$$
\theta x_1 + (1 - \theta) x_2 \in S
$$

几何意义是集合中任意两点连成的线段仍然完全包含在该集合中。

## 二、凸组合（Convex Combination）

给定向量空间 $\mathbb{R}^n$ 中的点 $x_1, x_2, \dots, x_k$，  
若存在一组实数 $\theta_1, \theta_2, \dots, \theta_k$，满足：

$$
\theta_i \ge 0, \quad i = 1, 2, \dots, k
$$

$$
\sum_{i=1}^{k} \theta_i = 1
$$

则称点

$$
x = \sum_{i=1}^{k} \theta_i x_i
$$

为这些点 $x_1, x_2, \dots, x_k$ 的 **凸组合（convex combination）**。

## 三、 凸函数（Convex Function）

定义在凸集 $S \subseteq \mathbb{R}^n$ 上的函数$f: S \to \mathbb{R}$ 被称为
**凸函数**，如果对于任意的 $x_1, x_2 \in S$ 和 $0 \le \theta \le 1$，都有：

$$
f(\theta x_1 + (1 - \theta) x_2)
\le
\theta f(x_1) + (1 - \theta) f(x_2)
$$

若等号仅在 $x_1 = x_2$ 时成立，则称 $f$ 为 **严格凸函数**。

## 四、 超平面（Hyperplane）

在向量空间 $\mathbb{R}^n$ 中，称集合

$$
H = \{ x \in \mathbb{R}^n \mid a^T x = b \}
$$

为一个 **超平面（hyperplane）**，  
其中 $a \in \mathbb{R}^n$ 是非零向量（法向量），$b \in \mathbb{R}$ 是常数。

- 超平面是 $\mathbb{R}^n$ 中维度为 $n-1$ 的平面。
- 超平面将空间分成两个半空间：

$$
H_+ = \{ x \mid a^T x \ge b \}, \quad H_- = \{ x \mid a^T x \le b \}
$$

- 两个半空间在欧式空间$R^n$上也是凸集，并且规定空集$\emptyset$也是凸集

## 五、超平面是凸集的证明

要证明 $H$ 是凸集，需证明：  
对任意 $x_1, x_2 \in H$，以及任意 $\theta \in [0,1]$，都有：

$$
\theta x_1 + (1-\theta)x_2 \in H
$$

**证明：**

1. 由于 $x_1, x_2 \in H$，所以

$$
a^T x_1 = b, \quad a^T x_2 = b
$$

2. 考虑凸组合 $\theta x_1 + (1-\theta)x_2$：

$$
a^T (\theta x_1 + (1-\theta)x_2)
= \theta a^T x_1 + (1-\theta) a^T x_2
= \theta b + (1-\theta)b
= b
$$

3. 因此

$$
\theta x_1 + (1-\theta)x_2 \in H
$$

所以 $H$ 是凸集。

> 💡 直观理解：超平面是“高维空间中的平面”，  
> 任意两点连线仍在超平面上，因此它是凸的，也是凹的。

## 六、 凸函数的性质

设 $f: C \to \mathbb{R}$ 是定义在凸集 $C \subseteq \mathbb{R}^n$ 上的凸函数。

1. 局部最优解也是全局最优解

若 $x^* \in C$ 是 $f$ 的局部最小点，则 $x^*$ 也是全局最小点：

$$
f(x^*) \le f(x), \quad \forall x \in C
$$

2. 一阶条件（可微函数）若 $f$ 可微，则 $f$ 是凸函数当且仅当：

$$
f(y) \ge f(x) + \nabla f(x)^T (y - x), \quad \forall x, y \in C
$$

> 直观：凸函数图形在每一点都位于该点切线的上方。

3. 二阶条件（$C^2$ 可微函数）若 $f$ 二阶可微，则 $f$ 是凸函数当且仅当其 Hessian 半正定：

$$
\nabla^2 f(x) \succeq 0, \quad \forall x \in C
$$

若 Hessian **严格正定**，则 $f$ 为严格凸函数：

$$
\nabla^2 f(x) \succ 0, \quad \forall x \in C
$$

4. 线性组合若 $f_1, f_2, \dots, f_m$ 是凸函数，且 $\alpha_i \ge 0$，则：

$$
f(x) = \sum_{i=1}^m \alpha_i f_i(x)
$$

也是凸函数。

5. 最大值保持凸性若 $f_1, f_2, \dots, f_m$ 是凸函数，则：

$$
f(x) = \max \{ f_1(x), f_2(x), \dots, f_m(x) \}
$$

也是凸函数。

## 七、凸函数的判定

1. 一阶判定（可微函数）若 $f$ 可微，则 $f$ 是凸函数当且仅当：

$$
f(y) \ge f(x) + \nabla f(x)^T (y - x), \quad \forall x, y \in C
$$

> 直观：函数图像在每一点的切平面（梯度线）下方。

2. 二阶判定（$C^2$ 可微函数）若 $f$ 二阶可微，则 $f$ 是凸函数当且仅当 Hessian 半正定：

$$
\nabla^2 f(x) \succeq 0, \quad \forall x \in C
$$

若 Hessian **严格正定**，则 $f$ 是严格凸函数：

$$
\nabla^2 f(x) \succ 0, \quad \forall x \in C
$$

> 注：判定时通常需要采用定义法或者二阶判定法，因为一阶判定存在任意点的要求，在计算上不好操作。

## 八、半正定矩阵

矩阵 $A$ 是半正定矩阵，当且仅当：

$$
x^T A x \ge 0, \quad \forall x \in \mathbb{R}^n
$$

判断方式，通常使用特征值判断：

$$
  A \succeq 0 \iff \text{所有特征值 } \lambda_i \ge 0
$$

使用特征值法考虑矩阵：

$$
A =
\begin{bmatrix}
2 & -1 & 0 \\
-1 & 2 & -1 \\
0 & -1 & 2
\end{bmatrix}
$$

写出特征方程，特征值 $\lambda$ 满足：

$$
\det(A - \lambda I) = 0
$$

$$
A - \lambda I =
\begin{bmatrix}
2-\lambda & -1 & 0 \\
-1 & 2-\lambda & -1 \\
0 & -1 & 2-\lambda
\end{bmatrix}
$$

计算行列式，三阶行列式展开：

$$
\det(A-\lambda I) =
(2-\lambda)
\begin{vmatrix} 2-\lambda & -1 \\ -1 & 2-\lambda \end{vmatrix}
- (-1)
\begin{vmatrix} -1 & -1 \\ 0 & 2-\lambda \end{vmatrix}
+ 0
$$

计算每一部分：

1. 二阶行列式：

$$
\begin{vmatrix} 2-\lambda & -1 \\ -1 & 2-\lambda \end{vmatrix} = (2-\lambda)^2 - 1
$$

2. 第二项：

$$
-(-1) \cdot \begin{vmatrix}-1 & -1 \\ 0 & 2-\lambda\end{vmatrix} = -(2-\lambda)
$$

所以总行列式：

$$
\det(A-\lambda I) = (2-\lambda)((2-\lambda)^2 - 1) - (2-\lambda) = (2-\lambda)((2-\lambda)^2 - 2)
$$

解特征方程

$$
(2-\lambda)((2-\lambda)^2 - 2) = 0
$$

解得：

$$
\lambda_1 = 2, \quad \lambda_2 = 2 - \sqrt{2}, \quad \lambda_3 = 2 + \sqrt{2}
$$

三个特征值都大于零，所以是半正定矩阵（事实上是正定矩阵）。

## 九、 凸规划（Convex Optimization / Convex Programming）

**凸规划问题** 是指目标函数和可行域都为凸的优化问题。

其标准形式为：

$$
\min \quad f(x), \quad x \in \mathbb{R}^n
$$

$$
\text{s.t.} \quad g_i(x)\le 0,\quad i=1,\dots,m,
$$

$$
h_j(x) = 0, j = 1,\dots,l
$$

其中：

- $f(x)$和$g_i(x)$ 都是凸函数
- $h_j(x)$ 是线性函数

> 注意：我们可以观察到除了最小化问题，还存在最大化问题，后面我们可以观察到两者是对偶问题，有很多方式可以将最大化问题转换为最小化问题。
