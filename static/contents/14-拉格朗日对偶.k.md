# 非线性规划的拉格朗日对偶理论

非线性规划（Nonlinear Programming,
NLP）的拉格朗日对偶理论，是线性规划对偶理论的推广，用于带约束的凸或非凸优化问题。

## 一、原始问题（Primal Problem）

设非线性规划为：

$$
\begin{aligned}
\min_{x \in \mathbb{R}^n} \quad & f(x) \\
\text{s.t.} \quad & g_i(x) \le 0, \ i=1,\dots,m, \\
& h_j(x) = 0, \ j=1,\dots,p,
\end{aligned}
$$

其中：

- $f(x)$ 为目标函数；
- $g_i(x)$ 为不等式约束；
- $h_j(x)$ 为等式约束。

## 二、拉格朗日函数（Lagrangian）

引入拉格朗日乘子：

- $\lambda_i \ge 0$ 对应不等式约束；
- $\mu_j$ 对应等式约束。

构造拉格朗日函数：

$$
L(x, \lambda, \mu) = f(x) + \sum_{i=1}^m \lambda_i g_i(x) + \sum_{j=1}^p \mu_j h_j(x)
$$

## 三、拉格朗日对偶函数（Dual Function）

定义对偶函数：

$$
g(\lambda, \mu) = \inf_{x} L(x, \lambda, \mu)
$$

- $g(\lambda, \mu)$ 对任意 $\lambda \ge 0$ 是 **下界函数**：
  $$
  g(\lambda, \mu) \le f(x), \quad \forall x \text{ 可行}.
  $$

## 四、对偶问题（Dual Problem）

对偶问题为：

$$
\begin{aligned}
\max_{\lambda \ge 0, \mu} \quad & g(\lambda, \mu)
\end{aligned}
$$

- 对偶问题总是提供原始问题的 **下界**（最小化问题）；
- 若原问题是凸问题，且满足 **Slater 条件**，则强对偶成立：
  $$
  \min f(x) = \max g(\lambda, \mu)
  $$

## 五、KKT 条件与对偶最优性

在凸问题下，原始可行点 $x^*$ 和对偶可行点 $(\lambda^*, \mu^*)$ 同时满足：

$$
\begin{cases}
\nabla_x L(x^*, \lambda^*, \mu^*) = 0, \\
g_i(x^*) \le 0, \ h_j(x^*) = 0, \\
\lambda_i^* \ge 0, \\
\lambda_i^* g_i(x^*) = 0,
\end{cases}
$$

则 $(x^*, \lambda^*, \mu^*)$ 为 **原始最优解和对偶最优解**。

## 六、判别最优性的方法

1. **凸问题**：
   - 只需检查 KKT 条件，满足即为全局最优。
2. **非凸问题**：
   - 计算 Hessian：
     $$
     H = \nabla^2_{xx} L(x^*, \lambda^*, \mu^*)
     $$
   - 检查可行方向上的曲率：
     - 半正定 → 局部极小点
     - 不定 → 鞍点
     - 负定 → 局部极大点

## 七、计算步骤总结

1. 写出拉格朗日函数 $L(x, \lambda, \mu)$。
2. 求梯度并联立 $\nabla_x L = 0$。
3. 代入原始约束 $g_i(x) \le 0, h_j(x) = 0$。
4. 添加互补松弛条件 $\lambda_i g_i(x) = 0, \lambda_i \ge 0$。
5. 联立求解得到候选 $(x^*, \lambda^*, \mu^*)$。
6. 若凸问题 → KKT 点即全局最优；若非凸 → 检查 Hessian 判别鞍点或局部极小值。

## 八、直观理解

- 拉格朗日对偶理论把 **约束问题转化为无约束的下界优化问题**；
- KKT 条件是原问题与对偶问题同时最优的桥梁；
- 对凸问题，KKT 点 + Slater 条件保证全局最优；
- 对非凸问题，需要二阶信息（Hessian）判断局部最优或鞍点。
