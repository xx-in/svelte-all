# 罚函数法

罚函数法（Penalty Method）是求解约束优化问题的一类数值方法，

## 示例

对于问题：

$$
min \quad f(x)  =(x_1-1)^2 + x_2^2 \\
s.t. \quad g(x) = x_2 - 1 \gt 0
$$

定义罚项：

对于不等式约束如下

$$
p(x) = \sigma[max\{0,-g(x)\}]^2 \\
$$

对于等式约束：

$$
p(x) = \sigma [g(x)]^2 \\
$$

带入$g(x)$有：

$$
p(x) =  \sigma[max\{0,1-x_2\}]^2
$$

将罚项处理为分段函数：

$$
p(x) = \begin{cases}
0, \quad x_2 \ge 1 \\
\sigma(x_2 - 1)^2 ,\quad x_2 \lt 1 \\
\end{cases}
$$

定义罚函数：

$$
F(x,\sigma) = \begin{cases}
(x_1-1)^2 + x_2^2, \quad x_2 \ge 1 \\
(x_1-1)^2 + x_2^2 + \sigma(x_2 - 1)^2 ,\quad x_2 \lt 1 \\
\end{cases}
$$

对分段函数求偏导：

$$
\frac{\partial F}{\partial x_1} = 2(x_1 - 1)
$$

$$
\frac{\partial F}{\partial x_2} = \begin{cases}
2x_2, \quad x_2 \ge 1 \\
2x_2 + 2\sigma(x_2 - 1) ,\quad x_2 \lt 1 \\
\end{cases}
$$

令两个偏导数都等于零，并让罚项$\sigma$趋向于正无穷，计算极限有：

$$
\bar{x}_\sigma = (1,1)^T
$$

最优解就是$(1,1)^T$
