# 共轭梯度法示例（二维含线性项，显式 A）

求解函数最小值：

$$
f(x_1,x_2) = x_1^2 + x_2^2 - x_1 + 2 x_2
$$

初始点：

$$
x_0 = \begin{pmatrix}0 \\ 0\end{pmatrix}
$$

---

## 1. 确定矩阵 $A$ 和向量 $b$

将函数写成标准二次形式：

$$
f(x) = \frac{1}{2} x^T A x - b^T x + c
$$

对比：

- 二次项：$x_1^2 + x_2^2 = \frac{1}{2} x^T A x \Rightarrow A = \begin{pmatrix}2 & 0 \\ 0 & 2\end{pmatrix}$
- 线性项：$-b^T x = -(-?)$，得到 $b = \begin{pmatrix}1 \\ -2\end{pmatrix}$
- 常数项：$c = 0$

梯度：

$$
g(x) = \nabla f(x) = A x - b
$$

---

## 2. 共轭梯度法迭代公式（用梯度表示）

初始化：

$$
g_0 = \nabla f(x_0), \quad d_0 = -g_0
$$

迭代公式：

$$
\lambda_k = \frac{g_k^T g_k}{d_k^T A d_k}, \quad x_{k+1} = x_k + \lambda_k d_k
$$

$$
g_{k+1} = \nabla f(x_{k+1}), \quad
\beta_k = \frac{g_{k+1}^T g_{k+1}}{g_k^T g_k}, \quad
d_{k+1} = -g_{k+1} + \beta_k d_k
$$

停止条件：

$$
\|g_k\| \approx 0
$$

> **说明**：
>
> - $g_k$：梯度
> - $d_k$：共轭方向
> - $\lambda_k$：步长，显式用 $A$
> - $\beta_k$：调整共轭方向系数

---

## 3. 第 0 步

梯度：

$$
g_0 = \nabla f(x_0) = A x_0 - b = \begin{pmatrix}2 & 0 \\ 0 & 2\end{pmatrix} \begin{pmatrix}0 \\ 0\end{pmatrix} - \begin{pmatrix}1 \\ -2\end{pmatrix} = \begin{pmatrix}-1 \\ 2\end{pmatrix}
$$

共轭方向：

$$
d_0 = -g_0 = \begin{pmatrix}1 \\ -2\end{pmatrix}
$$

步长：

$$
\lambda_0 = \frac{g_0^T g_0}{d_0^T A d_0} = \frac{(-1)^2 + 2^2}{(1,-2) \begin{pmatrix}2 & 0 \\ 0 & 2\end{pmatrix} \begin{pmatrix}1 \\ -2\end{pmatrix}} = \frac{5}{10} = 0.5
$$

更新点：

$$
x_1 = x_0 + \lambda_0 d_0 = \begin{pmatrix}0 \\ 0\end{pmatrix} + 0.5 \begin{pmatrix}1 \\ -2\end{pmatrix} = \begin{pmatrix}0.5 \\ -1\end{pmatrix}
$$

更新梯度：

$$
g_1 = \nabla f(x_1) = A x_1 - b = \begin{pmatrix}2 & 0 \\ 0 & 2\end{pmatrix} \begin{pmatrix}0.5 \\ -1\end{pmatrix} - \begin{pmatrix}1 \\ -2\end{pmatrix} = \begin{pmatrix}0 \\ 0\end{pmatrix}
$$

共轭系数：

$$
\beta_0 = \frac{g_1^T g_1}{g_0^T g_0} = 0
$$

更新共轭方向：

$$
d_1 = -g_1 + \beta_0 d_0 = \begin{pmatrix}0 \\ 0\end{pmatrix}
$$

迭代结束。

---

## 4. 结果

- **最优点**：

$$
x^* = \begin{pmatrix}0.5 \\ -1\end{pmatrix}
$$

- **最小值**：

$$
f(x^*) = (0.5)^2 + (-1)^2 - 0.5 + 2(-1) = -1.25
$$

- **特点**：二维二次函数，含线性项，从 (0,0) 开始，一步即可精确收敛。
