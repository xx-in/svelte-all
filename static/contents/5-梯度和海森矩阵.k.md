# 梯度与海森矩阵

## 1️⃣ 梯度（Gradient）

对于一个标量函数

$$
f: \mathbb{R}^n \to \mathbb{R}, \quad f(x_1, x_2, \dots, x_n)
$$

梯度是函数对各个变量的一阶偏导数组成的向量：

$$
\nabla f(x) =
\begin{bmatrix}
\frac{\partial f}{\partial x_1} \\\\
\frac{\partial f}{\partial x_2} \\\\
\vdots \\\\
\frac{\partial f}{\partial x_n}
\end{bmatrix} \in \mathbb{R}^n
$$

**直观解释**：

- 梯度指向函数在当前点 **增长最快的方向**。
- 梯度的模长表示函数在该方向上增长的速度。

**例子**：

$$
f(x, y) = x^2 + y^2 \implies
\nabla f(x, y) =
\begin{bmatrix} 2x \\\\ 2y \end{bmatrix}
$$

在点 $(1,1)$，梯度为 $(2,2)$。

---

## 2️⃣ 海森矩阵（Hessian Matrix）

海森矩阵是函数的二阶偏导数组成的矩阵：

$$
H_f(x) =
\begin{bmatrix}
\frac{\partial^2 f}{\partial x_1^2} & \frac{\partial^2 f}{\partial x_1 \partial x_2} & \dots & \frac{\partial^2 f}{\partial x_1 \partial x_n} \\\\
\frac{\partial^2 f}{\partial x_2 \partial x_1} & \frac{\partial^2 f}{\partial x_2^2} & \dots & \frac{\partial^2 f}{\partial x_2 \partial x_n} \\\\
\vdots & \vdots & \ddots & \vdots \\\\
\frac{\partial^2 f}{\partial x_n \partial x_1} & \frac{\partial^2 f}{\partial x_n \partial x_2} & \dots & \frac{\partial^2 f}{\partial x_n^2}
\end{bmatrix} \in \mathbb{R}^{n \times n}
$$

**直观解释**：

- 海森矩阵描述函数在某点 **曲率（凹凸程度）**。
- 判断局部极值：
  - $H_f \succ 0$：局部极小点
  - $H_f \prec 0$：局部极大点
  - 半正定或半负定：可能是鞍点或平坦点

**例子**：

$$
f(x, y) = x^2 + y^2 \implies
H_f(x, y) =
\begin{bmatrix} 2 & 0 \\\\ 0 & 2 \end{bmatrix}
$$

这是正定矩阵，所以原点是局部极小点。

---

## 3️⃣ 梯度与海森矩阵的关系

梯度是函数的一阶导数向量，海森矩阵是梯度的导数（雅可比矩阵）：

$$
H_f(x) = \nabla^2 f(x) = J(\nabla f(x))
$$

也就是说，海森矩阵描述了梯度的变化率，反映函数的曲率。

---

## 4️⃣ 总结

| 名称     | 符号                 | 维度         | 描述                   |
| -------- | -------------------- | ------------ | ---------------------- |
| 梯度     | $\nabla f$           | $n \times 1$ | 函数增长最快方向       |
| 海森矩阵 | $H_f$ / $\nabla^2 f$ | $n \times n$ | 函数曲率，判断极值类型 |
